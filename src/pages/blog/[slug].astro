---
import { getCollection, render } from 'astro:content'
import Post from '../../components/blog/Post/Post.astro'
import Layout from '../../layouts/Layout.astro'

// 1. Generate a new path for every collection entry
export async function getStaticPaths() {
    const posts = await getCollection('blog')
    console.debug(
        'posts',
        posts.map((post) => ({
            params: { slug: post.id },
            props: { post },
        })),
    )

    return posts.map((post) => ({
        params: { slug: post.id },
        props: { post },
    }))
}

// 2. For your template, you can get the entry directly from the prop
console.log('Astro.props ', Astro.props)
const { post } = Astro.props
const { Content } = await render(post)
---

<!-- <Post post={slug} /> -->
<Layout>
    <h1>{post.data.title}</h1>
    <Post
        post={{
            slug: post.id,
            ...post.data,
            id: post.id,
            date: post.data.date.toISOString(),
            coverImage: post.data.coverImage ?? '',
            ogImage: post.data.ogImage ?? '',
            categories: post.data.categories ?? [],
        }}
    />
</Layout>
